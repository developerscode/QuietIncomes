<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <!-- disable iPhone inital scale -->
    <meta name="viewport" content="width=device-width; initial-scale=1.0">
    <title>Quiet Incomes - New Message</title>
    <link rel="stylesheet" href="css/common-styles.css" type="text/css" />
    <!-- media queries css -->
    <!--<link rel="stylesheet" href="css/media-queries.css" type="text/css" />-->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <script type="text/javascript">

        $(document).ready(function () {
            getMembers();
            getInboxInfo();           

            moveToArchive();


        });
        function getMembers() {

            $.ajax({
                type: "POST",
                contentType: "application/json; charset=utf-8",
                url: "getdata.aspx/GetMemberDetails",
                data: "{}",
                dataType: 'json',
                crossDomain: true,
                success: function (data) {
                    var today = new Date();
                    $("#lblMemberTitle").text(data.d[0].MemberTitle);
                    $("#lblUserName").text(data.d[0].FullNmae);
                    $("#lblDream").text(data.d[0].AboutMe);
                    $("#lblNextGoal").text(data.d[0].GoalText1);
                    $("#lblStatus").text(data.d[0].AccountStatusID);
                    $("#lb1Inboxcount").text(data.d[0].InboxCount);
                    $("#lblSentCount").text(data.d[0].SentCount);
                    $("#lblAchivedCount").text(data.d[0].ArchiveCount);

                },
                error: function (result) {
                    alert("Error");
                }
            });
        }
        function getInboxInfo() {

            $.ajax({
                type: "POST",
                contentType: "application/json; charset=utf-8",
                url: "getdata.aspx/GetInboxDetails",
                data: "{}",
                dataType: 'json',
                crossDomain: true,
                success: function (data) {
                    var htmtext = "";

                    for (var i = 0; i < data.d.length; i++) {
                        // here showing the InboxDetails Info
                        htmtext = htmtext + "<div class='viewbox'><div class='user'><img src='images/smallprofile_pic_18.jpg' alt='profilepic' /><div class='userinfo'><p>" + data.d[i].FromMemberName + "</p><p>" + data.d[i].FromMemberTitle + "</p><p><span><img src='images/calendar_21.jpg' alt='calendar' />" + data.d[i].EmailDate + "</span></p></div></div><div class='view' style='width: 100%'><p style='width: 100%; text-align: left'>" + data.d[i].Subject + "</br>" + data.d[i].Message + ",<img style='float: right; margin-top: 10px; margin-right: 22px;' src='images/closed_brackets_30.jpg' alt='closedbrsckets' /></p></div><input id='replybox" + i + "' class='replybox' type='text' title='Enter your reply here' placeholder='Enter your reply here'/><div class='button'><input type='checkbox' id='chk" + i + "' value='" +data.d[i].InboxId +"' /><input class='send' id='send" + i + "' name='q' value='Reply' type='button' title='Archive' width='70px' height='23px' /></div></div>";
                    }
                    document.getElementById('lblHtmlforInbox').innerHTML = htmtext;
                },
                error: function (result) {
                    alert("Error");
                }
            });
        }
       
       
    </script>
    <script type="text/javascript">

        function funArchive() {
            var chkId = "";
            for (var i = 0; i < document.forms[0].elements.length; i++) {
                if (document.forms[0].elements[i].type == 'checkbox') {


                    if (document.forms[0].elements[i].checked == true) {
                        chkId = chkId + document.forms[0].elements[i].value + ',';                      


                    }

                }
            }
            if (chkId !='') {

                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    url: "getdata.aspx/MoveToArchive",
                    data: "{'Id':'" + chkId.toString() + "'}",
                    dataType: 'json',
                    crossDomain: true,
                    success: function (data) {
                        alert(data.d.toString());
                        getMembers();
                        getInboxInfo();

                    },
                    error: function (result) {
                        alert("Error");
                    }
                });
            }
            else {
                alert("Please select atleast on message");
            }
        }

        function funDelete() {
            var chkId = "";
            for (var i = 0; i < document.forms[0].elements.length; i++) {
                if (document.forms[0].elements[i].type == 'checkbox') {


                    if (document.forms[0].elements[i].checked == true) {
                        chkId = chkId + document.forms[0].elements[i].value + ',';


                    }

                }
            }
            if (chkId != '') {

                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    url: "getdata.aspx/DeleteMEssages",
                    data: "{'Id':'" + chkId.toString() + "'}",
                    dataType: 'json',
                    crossDomain: true,
                    success: function (data) {
                        alert(data.d.toString());
                        getMembers();
                        getInboxInfo();

                    },
                    error: function (result) {
                        alert("Error");
                    }
                });
            }
            else {
                alert("Please select atleast on message");
            }
        }
    </script>
</head>

<body>
 <form  action="">
    <div id="wrapper">
        <div id="login-box">
            <h1 style="color: #D5974E" class="logo_inner">
                <img src="images/quiteincomesinboxlogo_03.jpg" alt="Quite Incomes" /></h1>
            <div class="personinfo">
                <img src="images/profilepic.jpg" alt="profilepic" />
                <div class="info">
                    <p>
                        <label id="lblMemberTitle" runat="server" />
                        :<label id="lblUserName" runat="server"></label></p>
                    <p>
                        <span>Dream</span> :
                        <label id="lblDream" runat="server">
                        </label>
                    </p>
                    <p>
                        <span>Next Goal</span> :
                        <label id="lblNextGoal" runat="server">
                        </label>
                    </p>
                    <p>
                        <span>Status</span> :
                        <label id="lblStatus" runat="server" />
                    </p>
                </div>
                <!--info closed here-->
            </div>
            <!--personal info closed here-->
            <div id="menubar">
                <ul>
                    <li><a href="inbox.html"><span>New Message</span> <span class="number">
                        <label id="lb1Inboxcount" runat="server">
                        </label>
                    </span></a></li>
                    <li><a href="sent.html"><span>Sent Messages</span> <span class="number">
                        <label id="lblSentCount" runat="server">
                        </label>
                    </span></a></li>
                    <li><a href="archive.html"><span>Archived Messages</span> <span class="number">
                        <label id="lblAchivedCount" runat="server">
                        </label>
                    </span></a></li>
                </ul>
            </div>
            <!--menubar closed here-->
            <div><table><tr><td style="white-space:nowrap;"><input type="button" onclick="funArchive()" id="btnArchive" runat="server" class="archieve"  value="Archive"  title="ArchiveMessages" width="70px" height="10px"/></td>
            <td style="white-space:nowrap;"><input type="button" onclick="funDelete()" id="btnDelete" runat="server" class="archieve"  value="Delete"  title="ArchiveMessages" width="70px" height="10px"/></td></tr><tr><td colspan="2"><label id="lblHtmlforInbox" /></td></tr></table>
                
               
            </div>
        </div>
        <!--wrapper closed here-->
    </div>
  </form>
</body>
  
</html>
